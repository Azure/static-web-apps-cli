"use strict";(self.webpackChunk_azure_static_web_apps_cli_docs=self.webpackChunk_azure_static_web_apps_cli_docs||[]).push([[932],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var r=a.createContext({}),s=function(e){var t=a.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(r.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,r=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),c=s(n),m=i,k=c["".concat(r,".").concat(m)]||c[m]||d[m]||o;return n?a.createElement(k,l(l({ref:t},u),{},{components:n})):a.createElement(k,l({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,l=new Array(o);l[0]=c;var p={};for(var r in t)hasOwnProperty.call(t,r)&&(p[r]=t[r]);p.originalType=e,p.mdxType="string"==typeof e?e:i,l[1]=p;for(var s=2;s<o;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7881:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return r},default:function(){return m},frontMatter:function(){return p},metadata:function(){return s},toc:function(){return d}});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),l=["components"],p={sidebar_position:6,title:"swa deploy"},r=void 0,s={unversionedId:"cli/swa-deploy",id:"cli/swa-deploy",title:"swa deploy",description:"Synopsis",source:"@site/docs/cli/swa-deploy.md",sourceDirName:"cli",slug:"/cli/swa-deploy",permalink:"/static-web-apps-cli/docs/cli/swa-deploy",editUrl:"https://github.com/azure/static-web-apps-cli/tree/main/docs/www/docs/cli/swa-deploy.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"swa deploy"},sidebar:"tutorialSidebar",previous:{title:"swa login",permalink:"/static-web-apps-cli/docs/cli/swa-login"},next:{title:"Environment Variables",permalink:"/static-web-apps-cli/docs/cli/env-vars"}},u={},d=[{value:"Synopsis",id:"synopsis",level:2},{value:"Description",id:"description",level:2},{value:"Deployment token",id:"deployment-token",level:3},{value:"Deploy a front-end app without an API",id:"deploy-a-front-end-app-without-an-api",level:3},{value:"Deploy a front-end app with an API",id:"deploy-a-front-end-app-with-an-api",level:3},{value:"Deploy a Blazor app",id:"deploy-a-blazor-app",level:3},{value:"Deploy using the <code>swa-cli.config.json</code>",id:"deploy-using-the-swa-cliconfigjson",level:3},{value:"Options",id:"options",level:2},{value:"Usage",id:"usage",level:2},{value:"See Also",id:"see-also",level:2}],c={toc:d};function m(e){var t=e.components,n=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"synopsis"},"Synopsis"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy [configName|outputLocation] [options]\n")),(0,o.kt)("h2",{id:"description"},"Description"),(0,o.kt)("p",null,"This command is used to deploy the current project to Azure Static Web Apps. Here are some common use cases:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Deploy a front-end app without an API"),(0,o.kt)("li",{parentName:"ol"},"Deploy a front-end app with an API"),(0,o.kt)("li",{parentName:"ol"},"Deploy a Blazor app")),(0,o.kt)("h3",{id:"deployment-token"},"Deployment token"),(0,o.kt)("p",null,"The SWA CLI supports deploying using a deployment token. This is usually useful when deploying from a CI/CD environment. You can get a deployment token either from:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The ",(0,o.kt)("a",{parentName:"p",href:"https://portal.azure.com/"},"Azure portal"),": ",(0,o.kt)("strong",{parentName:"p"},"Home \u2192 Static Web App \u2192 Your Instance \u2192 Overview \u2192 Manage deployment token"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If you are using the ",(0,o.kt)("a",{parentName:"p",href:"https://aka.ms/azcli"},"Azure CLI"),", you can get the deployment token of your project using the following command:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'az staticwebapp secrets list --name <application-name> --query "properties.apiKey"\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you are using the Azure Static Web Apps CLI, you can use the following command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy --print-token\n")),(0,o.kt)("p",null,"You can then use that value with the ",(0,o.kt)("inlineCode",{parentName:"p"},"--deployment-token <token>")," or you can create an environment variable called ",(0,o.kt)("inlineCode",{parentName:"p"},"SWA_CLI_DEPLOYMENT_TOKEN")," and set it to the deployment token."),(0,o.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"IMPORTANT")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Don't store the deployment token in a public repository. It should be kept secret!"))),(0,o.kt)("h3",{id:"deploy-a-front-end-app-without-an-api"},"Deploy a front-end app without an API"),(0,o.kt)("p",null,"You can deploy a front-end application (without an API) to Azure Static Web Apps by running the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"If your front-end application requires a build step, run ",(0,o.kt)("a",{parentName:"li",href:"./swa-build"},(0,o.kt)("inlineCode",{parentName:"a"},"swa build"))," or refer to your application build instructions.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Option 1:")," From build folder you would like to deploy, run the deploy command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd build/\nswa deploy\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},'Note: the "build" folder must contain the static content of your app to be deployed!')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Option 2:")," You can also deploy a specific folder:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If your front-end application requires a build step, run ",(0,o.kt)("a",{parentName:"p",href:"./swa-build"},(0,o.kt)("inlineCode",{parentName:"a"},"swa build"))," or refer to your application build instructions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Deploy your app:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy ./my-dist\n")),(0,o.kt)("h3",{id:"deploy-a-front-end-app-with-an-api"},"Deploy a front-end app with an API"),(0,o.kt)("p",null,"To deploy both the front-end app and an API to Azure Static Web Apps, use the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If your front-end application requires a build step, run ",(0,o.kt)("a",{parentName:"p",href:"./swa-build"},(0,o.kt)("inlineCode",{parentName:"a"},"swa build"))," or refer to your application build instructions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Use the flags ",(0,o.kt)("inlineCode",{parentName:"p"},"--api-language")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"--api-version")," to specify the language and the runtime version of the backend api."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'swa deploy ./my-dist --api-location ./api --api-language "node" --api-version "16"\n')),(0,o.kt)("p",null,"Alternatively you can ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/static-web-apps/configuration#platform"},"configure")," the ",(0,o.kt)("inlineCode",{parentName:"p"},"apiRuntime")," in the ",(0,o.kt)("inlineCode",{parentName:"p"},"staticwebapp.config.json")," file"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "platform": {\n    "apiRuntime": "node:16"\n  }\n}\n')),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If your project doesn't have any ",(0,o.kt)("inlineCode",{parentName:"p"},"staticwebapp.config.json")," file, add one under your ",(0,o.kt)("inlineCode",{parentName:"p"},"outputLocation")," folder."))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Deploy your app:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy ./my-dist --api-location ./api\n")),(0,o.kt)("h3",{id:"deploy-a-blazor-app"},"Deploy a Blazor app"),(0,o.kt)("p",null,"To deploy a Blazor app with (optional) an API to Azure Static Web Apps, use the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Build your Blazor app in Release mode:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"dotnet publish -c Release -o bin/publish\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"From the root of your project, run the deploy command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy ./bin/publish/wwwroot --api-location ./Api\n")),(0,o.kt)("h3",{id:"deploy-using-the-swa-cliconfigjson"},"Deploy using the ",(0,o.kt)("inlineCode",{parentName:"h3"},"swa-cli.config.json")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The path for ",(0,o.kt)("inlineCode",{parentName:"p"},"outputLocation")," must be relative to the ",(0,o.kt)("inlineCode",{parentName:"p"},"appLocation"),"."))),(0,o.kt)("p",null,"If you are using a ",(0,o.kt)("a",{parentName:"p",href:"./swa-config"},(0,o.kt)("inlineCode",{parentName:"a"},"swa-cli.config.json"))," configuration file in your project and have a single configuration entry, for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "configurations": {\n    "my-app": {\n      "appLocation": "./",\n      "apiLocation": "api",\n      "outputLocation": "frontend",\n      "start": {\n        "outputLocation": "frontend"\n      },\n      "deploy": {\n        "outputLocation": "frontend"\n      }\n    }\n  }\n}\n')),(0,o.kt)("p",null,"Then you can deploy your application by running the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If your front-end application requires a build step, run ",(0,o.kt)("a",{parentName:"p",href:"./swa-build"},(0,o.kt)("inlineCode",{parentName:"a"},"swa build"))," or refer to your application build instructions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Deploy your app:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy\n")),(0,o.kt)("p",null,"If you have multiple configuration entries, you can provide the entry ID to specify which one to use:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy my-otherapp\n")),(0,o.kt)("h2",{id:"options"},"Options"),(0,o.kt)("p",null,"Here are the options you can use with ",(0,o.kt)("inlineCode",{parentName:"p"},"swa deploy"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-a, --app-location <path>"),': the folder containing the source code of the front-end application (default: "',(0,o.kt)("inlineCode",{parentName:"li"},"."),'")'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-i, --api-location <path>"),": the folder containing the source code of the API application"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-O, --output-location <path>"),": the folder containing the built source of the front-end application. The path is relative to ",(0,o.kt)("inlineCode",{parentName:"li"},"--app-location"),' (default: "',(0,o.kt)("inlineCode",{parentName:"li"},"."),'")'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--api-language <apiLanguage>"),': the runtime language of the function (default: "',(0,o.kt)("inlineCode",{parentName:"li"},"node"),'")'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--api-version <apiVersion>"),': the version of the function runtime language (default: "',(0,o.kt)("inlineCode",{parentName:"li"},"16"),'")'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-w, --swa-config-location <swaConfigLocation>"),": the directory where the staticwebapp.config.json file is located"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-d, --deployment-token <secret>"),": the secret token used to authenticate with the Static Web Apps"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-dr, --dry-run"),": simulate a deploy process without actually running it (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-pt, --print-token"),": print the deployment token (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--env [environment]"),': the type of deployment environment where to deploy the project (default: "',(0,o.kt)("inlineCode",{parentName:"li"},"preview"),'")'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-S, --subscription-id <subscriptionId>"),": Azure subscription ID used by this project (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"process.env.AZURE_SUBSCRIPTION_ID"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-R, --resource-group <resourceGroup>"),": Azure resource group used by this project"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-T, --tenant-id <tenantId>"),": Azure tenant ID (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"process.env.AZURE_TENANT_ID"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-C, --client-id <clientId>"),": Azure client ID"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-CS, --client-secret <clientSecret>"),": Azure client secret"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-n, --app-name <appName>"),": Azure Static Web App application name"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-CC, --clear-credentials"),": clear persisted credentials before login (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-u, --use-keychain"),": enable using the operating system native keychain for persistent credentials (default: ",(0,o.kt)("inlineCode",{parentName:"li"},"true"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-nu, --no-use-keychain"),": disable using the operating system native keychain"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-h, --help"),": display help for command")),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"Deploy using a deployment token"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy ./dist/ --api-location ./api/ --deployment-token <token>\n")),(0,o.kt)("p",null,"Deploy using a deployment token from the environment variables"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"SWA_CLI_DEPLOYMENT_TOKEN=123 swa deploy ./dist/ --api-location ./api/\n")),(0,o.kt)("p",null,"Deploy using ",(0,o.kt)("inlineCode",{parentName:"p"},"swa-cli.config.json")," file"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy\nswa deploy myconfig\n")),(0,o.kt)("p",null,"Print the deployment token"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy --print-token\n")),(0,o.kt)("p",null,"Provide function language and version"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'swa deploy ./my-dist --api-location ./api --api-language "node" --api-version "16"\n')),(0,o.kt)("p",null,"Deploy to a specific environment"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"swa deploy --env production\n")),(0,o.kt)("h2",{id:"see-also"},"See Also"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./swa"},"swa")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./swa-login"},"swa login")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./env-vars"},"Environment Variables"))))}m.isMDXComponent=!0}}]);